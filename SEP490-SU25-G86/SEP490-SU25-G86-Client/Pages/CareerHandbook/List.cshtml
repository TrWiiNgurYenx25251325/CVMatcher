@page
@model SEP490_SU25_G86_Client.Pages.CareerHandbook.ListModel
@{
    ViewData["Title"] = "Cẩm nang nghề nghiệp";
}

<section class="container my-5">
    <h2 class="mb-4 fw-bold">Cẩm nang nghề nghiệp</h2>

    @if (Model.PagedHandbooks == null || !Model.PagedHandbooks.Any())
    {
        <div class="alert alert-info">Chưa có bài viết nào.</div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var post in Model.PagedHandbooks)
            {
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0">
                        <img src="@(string.IsNullOrEmpty(post.ThumbnailUrl)
                                    ? Url.Content("~/assets/images/default_thumbnail_careerhandbook.png")
                                    : post.ThumbnailUrl)"
                             class="card-img-top"
                             alt="@post.Title"
                             style="height:200px;object-fit:cover;"
                             onerror="this.onerror=null;this.src='@Url.Content("~/assets/images/default_thumbnail_careerhandbook.png")';" />

                        <div class="card-body">
                            <span class="badge bg-secondary mb-2">@post.CategoryName</span>
                            <h5 class="card-title fw-bold">
                                <a asp-page="/CareerHandbook/Detail" asp-route-slug="@post.Slug" class="text-decoration-none text-dark">
                                    @post.Title
                                </a>
                            </h5>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-calendar-event"></i> @post.CreatedAt.ToString("dd/MM/yyyy")
                            </p>
                            <p class="card-text text-truncate" style="max-height: 48px; overflow: hidden;">
                                @Html.Raw(post.Content?.Length > 100 ? post.Content.Substring(0, 100) + "..." : post.Content)
                            </p>
                        </div>
                        <div class="card-footer bg-transparent border-0">
                            <a asp-page="/CareerHandbook/Detail" asp-route-slug="@post.Slug" class="btn btn-sm btn-outline-primary">Đọc tiếp</a>
                        </div>
                    </div>
                </div>
            }
        </div>

        <!-- 🔹 Pagination -->
        <div class="d-flex justify-content-center align-items-center mt-4">
            <nav aria-label="Pagination">
                <ul class="pagination pagination-sm mb-0">
                    @if (Model.Page > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="?page=@(Model.Page - 1)" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                    }
                    @for (int i = 1; i <= Model.TotalPages; i++)
                    {
                        <li class="page-item @(i == Model.Page ? "active" : "")">
                            <a class="page-link" href="?page=@i">@i</a>
                        </li>
                    }
                    @if (Model.Page < Model.TotalPages)
                    {
                        <li class="page-item">
                            <a class="page-link" href="?page=@(Model.Page + 1)" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    }
                </ul>
            </nav>
        </div>
    }
</section>

<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
